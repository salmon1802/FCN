2025-05-13 21:34:40,238 P723734 INFO Params: {
    "batch_norm": "True",
    "batch_size": "10000",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "KKBox_csv",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "128",
    "embedding_regularizer": "0.0005",
    "epochs": "100",
    "eval_steps": "None",
    "exp_num_layers": "3",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['msno', 'song_id', 'source_system_tab', 'source_screen_name', 'source_type', 'city', 'gender', 'registered_via', 'language'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 3, 'name': 'genre_ids', 'type': 'sequence'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 3, 'name': 'artist_name', 'type': 'sequence'}, {'active': True, 'dtype': 'str', 'name': 'isrc', 'preprocess': 'extract_country_code', 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'name': 'bd', 'preprocess': 'bucketize_age', 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'label'}",
    "learning_rate": "0.001",
    "lin_num_layers": "1",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "model": "FCNv2",
    "model_id": "FCNv2_KKBox_csv_001_51537e9f",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.2",
    "net_regularizer": "0",
    "num_heads": "1",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2025",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/KKBox_x1/test.csv",
    "train_data": "../../../data/KKBox_x1/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/KKBox_x1/valid.csv",
    "verbose": "1"
}
2025-05-13 21:34:40,238 P723734 INFO Set up feature processor...
2025-05-13 21:34:40,239 P723734 WARNING Skip rebuilding ../../../data/KKBox_csv/feature_map.json. Please delete it manually if rebuilding is required.
2025-05-13 21:34:40,239 P723734 INFO Load feature_map from json: ../../../data/KKBox_csv/feature_map.json
2025-05-13 21:34:40,239 P723734 INFO Set column index...
2025-05-13 21:34:40,239 P723734 INFO Feature specs: {
    "artist_name": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 11975, 'vocab_size': 11976, 'max_len': 3}",
    "bd": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "city": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "genre_ids": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 345, 'vocab_size': 346, 'max_len': 3}",
    "isrc": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 79, 'vocab_size': 80}",
    "language": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 11, 'vocab_size': 12}",
    "msno": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 25962, 'vocab_size': 25963}",
    "registered_via": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6, 'vocab_size': 7}",
    "song_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 53290, 'vocab_size': 53291}",
    "source_screen_name": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 20, 'vocab_size': 21}",
    "source_system_tab": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "source_type": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 13, 'vocab_size': 14}"
}
2025-05-13 21:34:44,234 P723734 INFO Total number of parameters: 22850322.
2025-05-13 21:34:44,234 P723734 INFO Loading data...
2025-05-13 21:34:44,234 P723734 INFO Loading data from h5: ../../../data/KKBox_csv/train.h5
2025-05-13 21:34:45,231 P723734 INFO Train samples: total/5901932, blocks/1
2025-05-13 21:34:45,232 P723734 INFO Loading data from h5: ../../../data/KKBox_csv/valid.h5
2025-05-13 21:34:45,364 P723734 INFO Validation samples: total/737743, blocks/1
2025-05-13 21:34:45,364 P723734 INFO Loading train and validation data done.
2025-05-13 21:34:45,364 P723734 INFO Start training: 591 batches/epoch
2025-05-13 21:34:45,364 P723734 INFO ************ Epoch=1 start ************
2025-05-13 21:36:48,201 P723734 INFO Train loss: 0.604959
2025-05-13 21:36:48,201 P723734 INFO Evaluation @epoch 1 - batch 591: 
2025-05-13 21:36:51,106 P723734 INFO ===
2025-05-13 21:36:51,107 P723734 INFO [Metrics] AUC: 0.804724 - logloss: 0.536043
2025-05-13 21:36:51,112 P723734 INFO Save best model: monitor(max)=0.804724
2025-05-13 21:36:51,369 P723734 INFO ************ Epoch=1 end ************
2025-05-13 21:38:53,742 P723734 INFO Train loss: 0.589577
2025-05-13 21:38:53,742 P723734 INFO Evaluation @epoch 2 - batch 591: 
2025-05-13 21:38:56,712 P723734 INFO ===
2025-05-13 21:38:56,712 P723734 INFO [Metrics] AUC: 0.816484 - logloss: 0.522929
2025-05-13 21:38:56,717 P723734 INFO Save best model: monitor(max)=0.816484
2025-05-13 21:38:56,972 P723734 INFO ************ Epoch=2 end ************
2025-05-13 21:40:59,253 P723734 INFO Train loss: 0.584957
2025-05-13 21:40:59,253 P723734 INFO Evaluation @epoch 3 - batch 591: 
2025-05-13 21:41:01,966 P723734 INFO ===
2025-05-13 21:41:01,966 P723734 INFO [Metrics] AUC: 0.822111 - logloss: 0.515769
2025-05-13 21:41:01,972 P723734 INFO Save best model: monitor(max)=0.822111
2025-05-13 21:41:02,274 P723734 INFO ************ Epoch=3 end ************
2025-05-13 21:43:04,844 P723734 INFO Train loss: 0.581564
2025-05-13 21:43:04,844 P723734 INFO Evaluation @epoch 4 - batch 591: 
2025-05-13 21:43:07,519 P723734 INFO ===
2025-05-13 21:43:07,519 P723734 INFO [Metrics] AUC: 0.825573 - logloss: 0.511272
2025-05-13 21:43:07,524 P723734 INFO Save best model: monitor(max)=0.825573
2025-05-13 21:43:07,802 P723734 INFO ************ Epoch=4 end ************
2025-05-13 21:45:10,766 P723734 INFO Train loss: 0.578670
2025-05-13 21:45:10,766 P723734 INFO Evaluation @epoch 5 - batch 591: 
2025-05-13 21:45:13,430 P723734 INFO ===
2025-05-13 21:45:13,431 P723734 INFO [Metrics] AUC: 0.829131 - logloss: 0.506511
2025-05-13 21:45:13,436 P723734 INFO Save best model: monitor(max)=0.829131
2025-05-13 21:45:13,687 P723734 INFO ************ Epoch=5 end ************
2025-05-13 21:47:15,939 P723734 INFO Train loss: 0.576230
2025-05-13 21:47:15,939 P723734 INFO Evaluation @epoch 6 - batch 591: 
2025-05-13 21:47:18,629 P723734 INFO ===
2025-05-13 21:47:18,629 P723734 INFO [Metrics] AUC: 0.830810 - logloss: 0.504717
2025-05-13 21:47:18,635 P723734 INFO Save best model: monitor(max)=0.830810
2025-05-13 21:47:18,940 P723734 INFO ************ Epoch=6 end ************
2025-05-13 21:49:21,346 P723734 INFO Train loss: 0.574106
2025-05-13 21:49:21,346 P723734 INFO Evaluation @epoch 7 - batch 591: 
2025-05-13 21:49:24,126 P723734 INFO ===
2025-05-13 21:49:24,127 P723734 INFO [Metrics] AUC: 0.832225 - logloss: 0.502626
2025-05-13 21:49:24,132 P723734 INFO Save best model: monitor(max)=0.832225
2025-05-13 21:49:24,419 P723734 INFO ************ Epoch=7 end ************
2025-05-13 21:51:26,910 P723734 INFO Train loss: 0.572269
2025-05-13 21:51:26,910 P723734 INFO Evaluation @epoch 8 - batch 591: 
2025-05-13 21:51:29,670 P723734 INFO ===
2025-05-13 21:51:29,670 P723734 INFO [Metrics] AUC: 0.833381 - logloss: 0.501218
2025-05-13 21:51:29,675 P723734 INFO Save best model: monitor(max)=0.833381
2025-05-13 21:51:29,941 P723734 INFO ************ Epoch=8 end ************
2025-05-13 21:53:32,536 P723734 INFO Train loss: 0.570910
2025-05-13 21:53:32,536 P723734 INFO Evaluation @epoch 9 - batch 591: 
2025-05-13 21:53:35,290 P723734 INFO ===
2025-05-13 21:53:35,290 P723734 INFO [Metrics] AUC: 0.835118 - logloss: 0.498864
2025-05-13 21:53:35,295 P723734 INFO Save best model: monitor(max)=0.835118
2025-05-13 21:53:35,571 P723734 INFO ************ Epoch=9 end ************
2025-05-13 21:55:38,714 P723734 INFO Train loss: 0.569369
2025-05-13 21:55:38,714 P723734 INFO Evaluation @epoch 10 - batch 591: 
2025-05-13 21:55:41,433 P723734 INFO ===
2025-05-13 21:55:41,433 P723734 INFO [Metrics] AUC: 0.836303 - logloss: 0.497450
2025-05-13 21:55:41,439 P723734 INFO Save best model: monitor(max)=0.836303
2025-05-13 21:55:41,717 P723734 INFO ************ Epoch=10 end ************
2025-05-13 21:57:43,750 P723734 INFO Train loss: 0.568054
2025-05-13 21:57:43,750 P723734 INFO Evaluation @epoch 11 - batch 591: 
2025-05-13 21:57:46,515 P723734 INFO ===
2025-05-13 21:57:46,515 P723734 INFO [Metrics] AUC: 0.837013 - logloss: 0.496316
2025-05-13 21:57:46,521 P723734 INFO Save best model: monitor(max)=0.837013
2025-05-13 21:57:46,812 P723734 INFO ************ Epoch=11 end ************
2025-05-13 21:59:49,683 P723734 INFO Train loss: 0.567135
2025-05-13 21:59:49,683 P723734 INFO Evaluation @epoch 12 - batch 591: 
2025-05-13 21:59:52,452 P723734 INFO ===
2025-05-13 21:59:52,452 P723734 INFO [Metrics] AUC: 0.837837 - logloss: 0.495389
2025-05-13 21:59:52,457 P723734 INFO Save best model: monitor(max)=0.837837
2025-05-13 21:59:52,737 P723734 INFO ************ Epoch=12 end ************
2025-05-13 22:01:55,210 P723734 INFO Train loss: 0.565850
2025-05-13 22:01:55,210 P723734 INFO Evaluation @epoch 13 - batch 591: 
2025-05-13 22:01:57,901 P723734 INFO ===
2025-05-13 22:01:57,901 P723734 INFO [Metrics] AUC: 0.838032 - logloss: 0.494921
2025-05-13 22:01:57,907 P723734 INFO Save best model: monitor(max)=0.838032
2025-05-13 22:01:58,143 P723734 INFO ************ Epoch=13 end ************
2025-05-13 22:04:00,382 P723734 INFO Train loss: 0.565364
2025-05-13 22:04:00,383 P723734 INFO Evaluation @epoch 14 - batch 591: 
2025-05-13 22:04:03,039 P723734 INFO ===
2025-05-13 22:04:03,039 P723734 INFO [Metrics] AUC: 0.838727 - logloss: 0.493970
2025-05-13 22:04:03,044 P723734 INFO Save best model: monitor(max)=0.838727
2025-05-13 22:04:03,307 P723734 INFO ************ Epoch=14 end ************
2025-05-13 22:06:06,533 P723734 INFO Train loss: 0.564286
2025-05-13 22:06:06,533 P723734 INFO Evaluation @epoch 15 - batch 591: 
2025-05-13 22:06:09,165 P723734 INFO ===
2025-05-13 22:06:09,166 P723734 INFO [Metrics] AUC: 0.839862 - logloss: 0.492475
2025-05-13 22:06:09,171 P723734 INFO Save best model: monitor(max)=0.839862
2025-05-13 22:06:09,453 P723734 INFO ************ Epoch=15 end ************
2025-05-13 22:08:11,830 P723734 INFO Train loss: 0.563409
2025-05-13 22:08:11,830 P723734 INFO Evaluation @epoch 16 - batch 591: 
2025-05-13 22:08:14,483 P723734 INFO ===
2025-05-13 22:08:14,483 P723734 INFO [Metrics] AUC: 0.840079 - logloss: 0.492304
2025-05-13 22:08:14,488 P723734 INFO Save best model: monitor(max)=0.840079
2025-05-13 22:08:14,776 P723734 INFO ************ Epoch=16 end ************
2025-05-13 22:10:16,833 P723734 INFO Train loss: 0.562755
2025-05-13 22:10:16,833 P723734 INFO Evaluation @epoch 17 - batch 591: 
2025-05-13 22:10:19,553 P723734 INFO ===
2025-05-13 22:10:19,553 P723734 INFO [Metrics] AUC: 0.840433 - logloss: 0.491858
2025-05-13 22:10:19,559 P723734 INFO Save best model: monitor(max)=0.840433
2025-05-13 22:10:19,848 P723734 INFO ************ Epoch=17 end ************
2025-05-13 22:12:22,026 P723734 INFO Train loss: 0.562015
2025-05-13 22:12:22,026 P723734 INFO Evaluation @epoch 18 - batch 591: 
2025-05-13 22:12:24,735 P723734 INFO ===
2025-05-13 22:12:24,735 P723734 INFO [Metrics] AUC: 0.840958 - logloss: 0.491148
2025-05-13 22:12:24,741 P723734 INFO Save best model: monitor(max)=0.840958
2025-05-13 22:12:25,055 P723734 INFO ************ Epoch=18 end ************
2025-05-13 22:14:27,379 P723734 INFO Train loss: 0.561316
2025-05-13 22:14:27,379 P723734 INFO Evaluation @epoch 19 - batch 591: 
2025-05-13 22:14:30,066 P723734 INFO ===
2025-05-13 22:14:30,066 P723734 INFO [Metrics] AUC: 0.841642 - logloss: 0.490438
2025-05-13 22:14:30,072 P723734 INFO Save best model: monitor(max)=0.841642
2025-05-13 22:14:30,384 P723734 INFO ************ Epoch=19 end ************
2025-05-13 22:16:32,442 P723734 INFO Train loss: 0.560753
2025-05-13 22:16:32,442 P723734 INFO Evaluation @epoch 20 - batch 591: 
2025-05-13 22:16:35,168 P723734 INFO ===
2025-05-13 22:16:35,168 P723734 INFO [Metrics] AUC: 0.842057 - logloss: 0.489949
2025-05-13 22:16:35,174 P723734 INFO Save best model: monitor(max)=0.842057
2025-05-13 22:16:35,461 P723734 INFO ************ Epoch=20 end ************
2025-05-13 22:18:37,424 P723734 INFO Train loss: 0.560251
2025-05-13 22:18:37,424 P723734 INFO Evaluation @epoch 21 - batch 591: 
2025-05-13 22:18:40,055 P723734 INFO ===
2025-05-13 22:18:40,055 P723734 INFO [Metrics] AUC: 0.842173 - logloss: 0.489861
2025-05-13 22:18:40,061 P723734 INFO Save best model: monitor(max)=0.842173
2025-05-13 22:18:40,303 P723734 INFO ************ Epoch=21 end ************
2025-05-13 22:20:42,664 P723734 INFO Train loss: 0.559620
2025-05-13 22:20:42,664 P723734 INFO Evaluation @epoch 22 - batch 591: 
2025-05-13 22:20:45,320 P723734 INFO ===
2025-05-13 22:20:45,320 P723734 INFO [Metrics] AUC: 0.842236 - logloss: 0.489552
2025-05-13 22:20:45,326 P723734 INFO Save best model: monitor(max)=0.842236
2025-05-13 22:20:45,629 P723734 INFO ************ Epoch=22 end ************
2025-05-13 22:22:48,010 P723734 INFO Train loss: 0.559253
2025-05-13 22:22:48,010 P723734 INFO Evaluation @epoch 23 - batch 591: 
2025-05-13 22:22:50,663 P723734 INFO ===
2025-05-13 22:22:50,663 P723734 INFO [Metrics] AUC: 0.842728 - logloss: 0.488979
2025-05-13 22:22:50,669 P723734 INFO Save best model: monitor(max)=0.842728
2025-05-13 22:22:50,970 P723734 INFO ************ Epoch=23 end ************
2025-05-13 22:24:53,742 P723734 INFO Train loss: 0.558731
2025-05-13 22:24:53,742 P723734 INFO Evaluation @epoch 24 - batch 591: 
2025-05-13 22:24:56,431 P723734 INFO ===
2025-05-13 22:24:56,431 P723734 INFO [Metrics] AUC: 0.842995 - logloss: 0.488502
2025-05-13 22:24:56,436 P723734 INFO Save best model: monitor(max)=0.842995
2025-05-13 22:24:56,705 P723734 INFO ************ Epoch=24 end ************
2025-05-13 22:26:59,370 P723734 INFO Train loss: 0.558173
2025-05-13 22:26:59,370 P723734 INFO Evaluation @epoch 25 - batch 591: 
2025-05-13 22:27:02,045 P723734 INFO ===
2025-05-13 22:27:02,045 P723734 INFO [Metrics] AUC: 0.843514 - logloss: 0.487963
2025-05-13 22:27:02,051 P723734 INFO Save best model: monitor(max)=0.843514
2025-05-13 22:27:02,357 P723734 INFO ************ Epoch=25 end ************
2025-05-13 22:29:04,429 P723734 INFO Train loss: 0.557726
2025-05-13 22:29:04,429 P723734 INFO Evaluation @epoch 26 - batch 591: 
2025-05-13 22:29:07,142 P723734 INFO ===
2025-05-13 22:29:07,142 P723734 INFO [Metrics] AUC: 0.843799 - logloss: 0.487482
2025-05-13 22:29:07,148 P723734 INFO Save best model: monitor(max)=0.843799
2025-05-13 22:29:07,445 P723734 INFO ************ Epoch=26 end ************
2025-05-13 22:31:09,962 P723734 INFO Train loss: 0.557198
2025-05-13 22:31:09,962 P723734 INFO Evaluation @epoch 27 - batch 591: 
2025-05-13 22:31:12,622 P723734 INFO ===
2025-05-13 22:31:12,622 P723734 INFO [Metrics] AUC: 0.843634 - logloss: 0.487793
2025-05-13 22:31:12,628 P723734 INFO Monitor(max)=0.843634 STOP!
2025-05-13 22:31:12,628 P723734 INFO Reduce learning rate on plateau: 0.000100
2025-05-13 22:31:12,774 P723734 INFO ************ Epoch=27 end ************
2025-05-13 22:33:15,497 P723734 INFO Train loss: 0.491490
2025-05-13 22:33:15,497 P723734 INFO Evaluation @epoch 28 - batch 591: 
2025-05-13 22:33:18,667 P723734 INFO ===
2025-05-13 22:33:18,668 P723734 INFO [Metrics] AUC: 0.854535 - logloss: 0.475862
2025-05-13 22:33:18,674 P723734 INFO Save best model: monitor(max)=0.854535
2025-05-13 22:33:18,991 P723734 INFO ************ Epoch=28 end ************
2025-05-13 22:35:21,883 P723734 INFO Train loss: 0.457969
2025-05-13 22:35:21,883 P723734 INFO Evaluation @epoch 29 - batch 591: 
2025-05-13 22:35:24,591 P723734 INFO ===
2025-05-13 22:35:24,591 P723734 INFO [Metrics] AUC: 0.857146 - logloss: 0.473796
2025-05-13 22:35:24,597 P723734 INFO Save best model: monitor(max)=0.857146
2025-05-13 22:35:24,870 P723734 INFO ************ Epoch=29 end ************
2025-05-13 22:37:27,483 P723734 INFO Train loss: 0.442937
2025-05-13 22:37:27,484 P723734 INFO Evaluation @epoch 30 - batch 591: 
2025-05-13 22:37:30,188 P723734 INFO ===
2025-05-13 22:37:30,188 P723734 INFO [Metrics] AUC: 0.857361 - logloss: 0.475879
2025-05-13 22:37:30,193 P723734 INFO Save best model: monitor(max)=0.857361
2025-05-13 22:37:30,482 P723734 INFO ************ Epoch=30 end ************
2025-05-13 22:39:32,927 P723734 INFO Train loss: 0.432499
2025-05-13 22:39:32,927 P723734 INFO Evaluation @epoch 31 - batch 591: 
2025-05-13 22:39:35,663 P723734 INFO ===
2025-05-13 22:39:35,663 P723734 INFO [Metrics] AUC: 0.857092 - logloss: 0.478702
2025-05-13 22:39:35,668 P723734 INFO Monitor(max)=0.857092 STOP!
2025-05-13 22:39:35,668 P723734 INFO Reduce learning rate on plateau: 0.000010
2025-05-13 22:39:35,821 P723734 INFO ************ Epoch=31 end ************
2025-05-13 22:41:38,472 P723734 INFO Train loss: 0.402583
2025-05-13 22:41:38,473 P723734 INFO Evaluation @epoch 32 - batch 591: 
2025-05-13 22:41:41,148 P723734 INFO ===
2025-05-13 22:41:41,149 P723734 INFO [Metrics] AUC: 0.855342 - logloss: 0.494714
2025-05-13 22:41:41,154 P723734 INFO Monitor(max)=0.855342 STOP!
2025-05-13 22:41:41,154 P723734 INFO Reduce learning rate on plateau: 0.000001
2025-05-13 22:41:41,154 P723734 INFO ********* Epoch==32 early stop *********
2025-05-13 22:41:41,363 P723734 INFO Training finished.
2025-05-13 22:41:41,363 P723734 INFO Load best model: /root/autodl-tmp/model_zoo/DCNv3/DCNv3_torch/checkpoints/KKBox_csv/FCNv2_KKBox_csv_001_51537e9f.model
2025-05-13 22:41:41,415 P723734 INFO ****** Validation evaluation ******
2025-05-13 22:41:44,125 P723734 INFO ===
2025-05-13 22:41:44,125 P723734 INFO [Metrics] logloss: 0.475879 - AUC: 0.857361
2025-05-13 22:41:44,204 P723734 INFO ******** Test evaluation ********
2025-05-13 22:41:44,204 P723734 INFO Loading data...
2025-05-13 22:41:44,205 P723734 INFO Loading data from h5: ../../../data/KKBox_csv/test.h5
2025-05-13 22:41:44,332 P723734 INFO Test samples: total/737743, blocks/1
2025-05-13 22:41:44,332 P723734 INFO Loading test data done.
2025-05-13 22:41:47,086 P723734 INFO ===
2025-05-13 22:41:47,086 P723734 INFO [Metrics] logloss: 0.475490 - AUC: 0.857494
