2025-05-13 16:47:53,317 P640115 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "exp_num_layers": "2",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "lin_num_layers": "2",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "FCNv2",
    "model_id": "FCNv2_ML_1M_007_4f68508c",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_heads": "1",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML_1M/test.csv",
    "train_data": "../../../data/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML_1M/valid.csv",
    "verbose": "1"
}
2025-05-13 16:47:53,317 P640115 INFO Set up feature processor...
2025-05-13 16:47:53,317 P640115 WARNING Skip rebuilding ../../../data/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2025-05-13 16:47:53,317 P640115 INFO Load feature_map from json: ../../../data/ML_1M_7_x1/feature_map.json
2025-05-13 16:47:53,317 P640115 INFO Set column index...
2025-05-13 16:47:53,317 P640115 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20, 'max_len': 5}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3642, 'vocab_size': 3643}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}"
}
2025-05-13 16:47:57,289 P640115 INFO Total number of parameters: 208226.
2025-05-13 16:47:57,290 P640115 INFO Loading data...
2025-05-13 16:47:57,290 P640115 INFO Loading data from h5: ../../../data/ML_1M_7_x1/train.h5
2025-05-13 16:47:57,342 P640115 INFO Train samples: total/591209, blocks/1
2025-05-13 16:47:57,342 P640115 INFO Loading data from h5: ../../../data/ML_1M_7_x1/valid.h5
2025-05-13 16:47:57,349 P640115 INFO Validation samples: total/73901, blocks/1
2025-05-13 16:47:57,349 P640115 INFO Loading train and validation data done.
2025-05-13 16:47:57,350 P640115 INFO Start training: 145 batches/epoch
2025-05-13 16:47:57,350 P640115 INFO ************ Epoch=1 start ************
2025-05-13 16:48:02,164 P640115 INFO Train loss: 0.425282
2025-05-13 16:48:02,165 P640115 INFO Evaluation @epoch 1 - batch 145: 
2025-05-13 16:48:03,652 P640115 INFO ===
2025-05-13 16:48:03,652 P640115 INFO [Metrics] AUC: 0.867311 - logloss: 0.350188
2025-05-13 16:48:03,652 P640115 INFO Save best model: monitor(max)=0.867311
2025-05-13 16:48:03,883 P640115 INFO ************ Epoch=1 end ************
2025-05-13 16:48:08,401 P640115 INFO Train loss: 0.377670
2025-05-13 16:48:08,401 P640115 INFO Evaluation @epoch 2 - batch 145: 
2025-05-13 16:48:10,027 P640115 INFO ===
2025-05-13 16:48:10,027 P640115 INFO [Metrics] AUC: 0.874426 - logloss: 0.340453
2025-05-13 16:48:10,027 P640115 INFO Save best model: monitor(max)=0.874426
2025-05-13 16:48:10,233 P640115 INFO ************ Epoch=2 end ************
2025-05-13 16:48:15,800 P640115 INFO Train loss: 0.371050
2025-05-13 16:48:15,801 P640115 INFO Evaluation @epoch 3 - batch 145: 
2025-05-13 16:48:17,547 P640115 INFO ===
2025-05-13 16:48:17,547 P640115 INFO [Metrics] AUC: 0.880561 - logloss: 0.334790
2025-05-13 16:48:17,547 P640115 INFO Save best model: monitor(max)=0.880561
2025-05-13 16:48:17,756 P640115 INFO ************ Epoch=3 end ************
2025-05-13 16:48:23,299 P640115 INFO Train loss: 0.366180
2025-05-13 16:48:23,299 P640115 INFO Evaluation @epoch 4 - batch 145: 
2025-05-13 16:48:25,007 P640115 INFO ===
2025-05-13 16:48:25,007 P640115 INFO [Metrics] AUC: 0.887745 - logloss: 0.324914
2025-05-13 16:48:25,007 P640115 INFO Save best model: monitor(max)=0.887745
2025-05-13 16:48:25,235 P640115 INFO ************ Epoch=4 end ************
2025-05-13 16:48:30,787 P640115 INFO Train loss: 0.362248
2025-05-13 16:48:30,787 P640115 INFO Evaluation @epoch 5 - batch 145: 
2025-05-13 16:48:32,478 P640115 INFO ===
2025-05-13 16:48:32,478 P640115 INFO [Metrics] AUC: 0.890032 - logloss: 0.321470
2025-05-13 16:48:32,478 P640115 INFO Save best model: monitor(max)=0.890032
2025-05-13 16:48:32,697 P640115 INFO ************ Epoch=5 end ************
2025-05-13 16:48:38,742 P640115 INFO Train loss: 0.358784
2025-05-13 16:48:38,742 P640115 INFO Evaluation @epoch 6 - batch 145: 
2025-05-13 16:48:40,390 P640115 INFO ===
2025-05-13 16:48:40,390 P640115 INFO [Metrics] AUC: 0.892795 - logloss: 0.318283
2025-05-13 16:48:40,390 P640115 INFO Save best model: monitor(max)=0.892795
2025-05-13 16:48:40,605 P640115 INFO ************ Epoch=6 end ************
2025-05-13 16:48:46,369 P640115 INFO Train loss: 0.355597
2025-05-13 16:48:46,370 P640115 INFO Evaluation @epoch 7 - batch 145: 
2025-05-13 16:48:48,266 P640115 INFO ===
2025-05-13 16:48:48,266 P640115 INFO [Metrics] AUC: 0.893604 - logloss: 0.317597
2025-05-13 16:48:48,266 P640115 INFO Save best model: monitor(max)=0.893604
2025-05-13 16:48:48,458 P640115 INFO ************ Epoch=7 end ************
2025-05-13 16:48:54,387 P640115 INFO Train loss: 0.353882
2025-05-13 16:48:54,387 P640115 INFO Evaluation @epoch 8 - batch 145: 
2025-05-13 16:48:56,227 P640115 INFO ===
2025-05-13 16:48:56,227 P640115 INFO [Metrics] AUC: 0.895394 - logloss: 0.314867
2025-05-13 16:48:56,227 P640115 INFO Save best model: monitor(max)=0.895394
2025-05-13 16:48:56,433 P640115 INFO ************ Epoch=8 end ************
2025-05-13 16:49:02,247 P640115 INFO Train loss: 0.351369
2025-05-13 16:49:02,247 P640115 INFO Evaluation @epoch 9 - batch 145: 
2025-05-13 16:49:04,087 P640115 INFO ===
2025-05-13 16:49:04,087 P640115 INFO [Metrics] AUC: 0.894014 - logloss: 0.316535
2025-05-13 16:49:04,087 P640115 INFO Monitor(max)=0.894014 STOP!
2025-05-13 16:49:04,087 P640115 INFO Reduce learning rate on plateau: 0.000100
2025-05-13 16:49:04,321 P640115 INFO ************ Epoch=9 end ************
2025-05-13 16:49:10,233 P640115 INFO Train loss: 0.318721
2025-05-13 16:49:10,233 P640115 INFO Evaluation @epoch 10 - batch 145: 
2025-05-13 16:49:12,040 P640115 INFO ===
2025-05-13 16:49:12,040 P640115 INFO [Metrics] AUC: 0.901812 - logloss: 0.306711
2025-05-13 16:49:12,040 P640115 INFO Save best model: monitor(max)=0.901812
2025-05-13 16:49:12,238 P640115 INFO ************ Epoch=10 end ************
2025-05-13 16:49:18,189 P640115 INFO Train loss: 0.302562
2025-05-13 16:49:18,190 P640115 INFO Evaluation @epoch 11 - batch 145: 
2025-05-13 16:49:19,999 P640115 INFO ===
2025-05-13 16:49:19,999 P640115 INFO [Metrics] AUC: 0.904170 - logloss: 0.303462
2025-05-13 16:49:19,999 P640115 INFO Save best model: monitor(max)=0.904170
2025-05-13 16:49:20,221 P640115 INFO ************ Epoch=11 end ************
2025-05-13 16:49:25,921 P640115 INFO Train loss: 0.293967
2025-05-13 16:49:25,921 P640115 INFO Evaluation @epoch 12 - batch 145: 
2025-05-13 16:49:27,673 P640115 INFO ===
2025-05-13 16:49:27,673 P640115 INFO [Metrics] AUC: 0.905003 - logloss: 0.302752
2025-05-13 16:49:27,673 P640115 INFO Save best model: monitor(max)=0.905003
2025-05-13 16:49:27,854 P640115 INFO ************ Epoch=12 end ************
2025-05-13 16:49:33,488 P640115 INFO Train loss: 0.288088
2025-05-13 16:49:33,488 P640115 INFO Evaluation @epoch 13 - batch 145: 
2025-05-13 16:49:35,407 P640115 INFO ===
2025-05-13 16:49:35,408 P640115 INFO [Metrics] AUC: 0.905208 - logloss: 0.303141
2025-05-13 16:49:35,408 P640115 INFO Save best model: monitor(max)=0.905208
2025-05-13 16:49:35,615 P640115 INFO ************ Epoch=13 end ************
2025-05-13 16:49:41,401 P640115 INFO Train loss: 0.283148
2025-05-13 16:49:41,402 P640115 INFO Evaluation @epoch 14 - batch 145: 
2025-05-13 16:49:43,187 P640115 INFO ===
2025-05-13 16:49:43,187 P640115 INFO [Metrics] AUC: 0.904894 - logloss: 0.303649
2025-05-13 16:49:43,187 P640115 INFO Monitor(max)=0.904894 STOP!
2025-05-13 16:49:43,187 P640115 INFO Reduce learning rate on plateau: 0.000010
2025-05-13 16:49:43,371 P640115 INFO ************ Epoch=14 end ************
2025-05-13 16:49:49,202 P640115 INFO Train loss: 0.269440
2025-05-13 16:49:49,203 P640115 INFO Evaluation @epoch 15 - batch 145: 
2025-05-13 16:49:50,969 P640115 INFO ===
2025-05-13 16:49:50,970 P640115 INFO [Metrics] AUC: 0.904875 - logloss: 0.305311
2025-05-13 16:49:50,970 P640115 INFO Monitor(max)=0.904875 STOP!
2025-05-13 16:49:50,970 P640115 INFO Reduce learning rate on plateau: 0.000001
2025-05-13 16:49:50,970 P640115 INFO ********* Epoch==15 early stop *********
2025-05-13 16:49:51,147 P640115 INFO Training finished.
2025-05-13 16:49:51,147 P640115 INFO Load best model: /root/autodl-tmp/model_zoo/DCNv3/DCNv3_torch/checkpoints/ML_1M_7_x1/FCNv2_ML_1M_007_4f68508c.model
2025-05-13 16:49:51,152 P640115 INFO ****** Validation evaluation ******
2025-05-13 16:49:53,047 P640115 INFO ===
2025-05-13 16:49:53,048 P640115 INFO [Metrics] logloss: 0.303141 - AUC: 0.905208
2025-05-13 16:49:53,094 P640115 INFO ******** Test evaluation ********
2025-05-13 16:49:53,094 P640115 INFO Loading data...
2025-05-13 16:49:53,094 P640115 INFO Loading data from h5: ../../../data/ML_1M_7_x1/test.h5
2025-05-13 16:49:53,099 P640115 INFO Test samples: total/73902, blocks/1
2025-05-13 16:49:53,099 P640115 INFO Loading test data done.
2025-05-13 16:49:54,811 P640115 INFO ===
2025-05-13 16:49:54,811 P640115 INFO [Metrics] logloss: 0.301901 - AUC: 0.906055
