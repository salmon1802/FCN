2025-05-13 16:29:54,762 P199553 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "1",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ECN",
    "model_id": "ECN_ML_1M_7_x1_007_9643bdea",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "8",
    "num_heads": "1",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2025",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML_1M/test.csv",
    "train_data": "../../../data/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML_1M/valid.csv",
    "verbose": "1"
}
2025-05-13 16:29:54,763 P199553 INFO Set up feature processor...
2025-05-13 16:29:54,763 P199553 WARNING Skip rebuilding ../../../data/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2025-05-13 16:29:54,763 P199553 INFO Load feature_map from json: ../../../data/ML_1M_7_x1/feature_map.json
2025-05-13 16:29:54,763 P199553 INFO Set column index...
2025-05-13 16:29:54,763 P199553 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20, 'max_len': 5}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3642, 'vocab_size': 3643}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}"
}
2025-05-13 16:29:58,724 P199553 INFO Total number of parameters: 208113.
2025-05-13 16:29:58,724 P199553 INFO Loading data...
2025-05-13 16:29:58,724 P199553 INFO Loading data from h5: ../../../data/ML_1M_7_x1/train.h5
2025-05-13 16:29:58,780 P199553 INFO Train samples: total/591209, blocks/1
2025-05-13 16:29:58,780 P199553 INFO Loading data from h5: ../../../data/ML_1M_7_x1/valid.h5
2025-05-13 16:29:58,789 P199553 INFO Validation samples: total/73901, blocks/1
2025-05-13 16:29:58,789 P199553 INFO Loading train and validation data done.
2025-05-13 16:29:58,789 P199553 INFO Start training: 145 batches/epoch
2025-05-13 16:29:58,789 P199553 INFO ************ Epoch=1 start ************
2025-05-13 16:30:04,194 P199553 INFO Train loss: 0.479631
2025-05-13 16:30:04,194 P199553 INFO Evaluation @epoch 1 - batch 145: 
2025-05-13 16:30:05,941 P199553 INFO ===
2025-05-13 16:30:05,941 P199553 INFO [Metrics] AUC: 0.868783 - logloss: 0.350113
2025-05-13 16:30:05,941 P199553 INFO Save best model: monitor(max)=0.868783
2025-05-13 16:30:06,173 P199553 INFO ************ Epoch=1 end ************
2025-05-13 16:30:11,617 P199553 INFO Train loss: 0.417676
2025-05-13 16:30:11,617 P199553 INFO Evaluation @epoch 2 - batch 145: 
2025-05-13 16:30:13,530 P199553 INFO ===
2025-05-13 16:30:13,530 P199553 INFO [Metrics] AUC: 0.873041 - logloss: 0.343182
2025-05-13 16:30:13,530 P199553 INFO Save best model: monitor(max)=0.873041
2025-05-13 16:30:13,731 P199553 INFO ************ Epoch=2 end ************
2025-05-13 16:30:19,592 P199553 INFO Train loss: 0.416494
2025-05-13 16:30:19,592 P199553 INFO Evaluation @epoch 3 - batch 145: 
2025-05-13 16:30:21,535 P199553 INFO ===
2025-05-13 16:30:21,535 P199553 INFO [Metrics] AUC: 0.876308 - logloss: 0.339534
2025-05-13 16:30:21,536 P199553 INFO Save best model: monitor(max)=0.876308
2025-05-13 16:30:21,737 P199553 INFO ************ Epoch=3 end ************
2025-05-13 16:30:27,821 P199553 INFO Train loss: 0.410603
2025-05-13 16:30:27,821 P199553 INFO Evaluation @epoch 4 - batch 145: 
2025-05-13 16:30:29,470 P199553 INFO ===
2025-05-13 16:30:29,470 P199553 INFO [Metrics] AUC: 0.882288 - logloss: 0.333371
2025-05-13 16:30:29,470 P199553 INFO Save best model: monitor(max)=0.882288
2025-05-13 16:30:29,678 P199553 INFO ************ Epoch=4 end ************
2025-05-13 16:30:35,213 P199553 INFO Train loss: 0.407328
2025-05-13 16:30:35,214 P199553 INFO Evaluation @epoch 5 - batch 145: 
2025-05-13 16:30:36,994 P199553 INFO ===
2025-05-13 16:30:36,994 P199553 INFO [Metrics] AUC: 0.885875 - logloss: 0.328192
2025-05-13 16:30:36,995 P199553 INFO Save best model: monitor(max)=0.885875
2025-05-13 16:30:37,265 P199553 INFO ************ Epoch=5 end ************
2025-05-13 16:30:42,672 P199553 INFO Train loss: 0.407008
2025-05-13 16:30:42,672 P199553 INFO Evaluation @epoch 6 - batch 145: 
2025-05-13 16:30:44,590 P199553 INFO ===
2025-05-13 16:30:44,590 P199553 INFO [Metrics] AUC: 0.886326 - logloss: 0.330657
2025-05-13 16:30:44,590 P199553 INFO Save best model: monitor(max)=0.886326
2025-05-13 16:30:44,786 P199553 INFO ************ Epoch=6 end ************
2025-05-13 16:30:50,017 P199553 INFO Train loss: 0.402982
2025-05-13 16:30:50,017 P199553 INFO Evaluation @epoch 7 - batch 145: 
2025-05-13 16:30:51,812 P199553 INFO ===
2025-05-13 16:30:51,812 P199553 INFO [Metrics] AUC: 0.889707 - logloss: 0.324564
2025-05-13 16:30:51,812 P199553 INFO Save best model: monitor(max)=0.889707
2025-05-13 16:30:52,089 P199553 INFO ************ Epoch=7 end ************
2025-05-13 16:30:57,430 P199553 INFO Train loss: 0.400402
2025-05-13 16:30:57,431 P199553 INFO Evaluation @epoch 8 - batch 145: 
2025-05-13 16:30:59,101 P199553 INFO ===
2025-05-13 16:30:59,101 P199553 INFO [Metrics] AUC: 0.890212 - logloss: 0.323564
2025-05-13 16:30:59,102 P199553 INFO Save best model: monitor(max)=0.890212
2025-05-13 16:30:59,298 P199553 INFO ************ Epoch=8 end ************
2025-05-13 16:31:04,588 P199553 INFO Train loss: 0.378166
2025-05-13 16:31:04,588 P199553 INFO Evaluation @epoch 9 - batch 145: 
2025-05-13 16:31:06,622 P199553 INFO ===
2025-05-13 16:31:06,622 P199553 INFO [Metrics] AUC: 0.891822 - logloss: 0.320105
2025-05-13 16:31:06,622 P199553 INFO Save best model: monitor(max)=0.891822
2025-05-13 16:31:06,827 P199553 INFO ************ Epoch=9 end ************
2025-05-13 16:31:11,633 P199553 INFO Train loss: 0.380227
2025-05-13 16:31:11,633 P199553 INFO Evaluation @epoch 10 - batch 145: 
2025-05-13 16:31:13,278 P199553 INFO ===
2025-05-13 16:31:13,278 P199553 INFO [Metrics] AUC: 0.892046 - logloss: 0.319738
2025-05-13 16:31:13,278 P199553 INFO Save best model: monitor(max)=0.892046
2025-05-13 16:31:13,527 P199553 INFO ************ Epoch=10 end ************
2025-05-13 16:31:18,123 P199553 INFO Train loss: 0.368810
2025-05-13 16:31:18,124 P199553 INFO Evaluation @epoch 11 - batch 145: 
2025-05-13 16:31:19,785 P199553 INFO ===
2025-05-13 16:31:19,785 P199553 INFO [Metrics] AUC: 0.893639 - logloss: 0.317631
2025-05-13 16:31:19,785 P199553 INFO Save best model: monitor(max)=0.893639
2025-05-13 16:31:20,030 P199553 INFO ************ Epoch=11 end ************
2025-05-13 16:31:24,666 P199553 INFO Train loss: 0.370367
2025-05-13 16:31:24,666 P199553 INFO Evaluation @epoch 12 - batch 145: 
2025-05-13 16:31:26,255 P199553 INFO ===
2025-05-13 16:31:26,255 P199553 INFO [Metrics] AUC: 0.895324 - logloss: 0.316242
2025-05-13 16:31:26,255 P199553 INFO Save best model: monitor(max)=0.895324
2025-05-13 16:31:26,544 P199553 INFO ************ Epoch=12 end ************
2025-05-13 16:31:31,286 P199553 INFO Train loss: 0.367461
2025-05-13 16:31:31,286 P199553 INFO Evaluation @epoch 13 - batch 145: 
2025-05-13 16:31:32,892 P199553 INFO ===
2025-05-13 16:31:32,892 P199553 INFO [Metrics] AUC: 0.895270 - logloss: 0.316108
2025-05-13 16:31:32,892 P199553 INFO Monitor(max)=0.895270 STOP!
2025-05-13 16:31:32,892 P199553 INFO Reduce learning rate on plateau: 0.000100
2025-05-13 16:31:33,081 P199553 INFO ************ Epoch=13 end ************
2025-05-13 16:31:37,629 P199553 INFO Train loss: 0.333712
2025-05-13 16:31:37,629 P199553 INFO Evaluation @epoch 14 - batch 145: 
2025-05-13 16:31:39,303 P199553 INFO ===
2025-05-13 16:31:39,303 P199553 INFO [Metrics] AUC: 0.902049 - logloss: 0.307141
2025-05-13 16:31:39,303 P199553 INFO Save best model: monitor(max)=0.902049
2025-05-13 16:31:39,522 P199553 INFO ************ Epoch=14 end ************
2025-05-13 16:31:44,188 P199553 INFO Train loss: 0.316068
2025-05-13 16:31:44,189 P199553 INFO Evaluation @epoch 15 - batch 145: 
2025-05-13 16:31:45,893 P199553 INFO ===
2025-05-13 16:31:45,893 P199553 INFO [Metrics] AUC: 0.904276 - logloss: 0.304721
2025-05-13 16:31:45,893 P199553 INFO Save best model: monitor(max)=0.904276
2025-05-13 16:31:46,091 P199553 INFO ************ Epoch=15 end ************
2025-05-13 16:31:50,936 P199553 INFO Train loss: 0.305952
2025-05-13 16:31:50,937 P199553 INFO Evaluation @epoch 16 - batch 145: 
2025-05-13 16:31:52,587 P199553 INFO ===
2025-05-13 16:31:52,588 P199553 INFO [Metrics] AUC: 0.905087 - logloss: 0.303927
2025-05-13 16:31:52,588 P199553 INFO Save best model: monitor(max)=0.905087
2025-05-13 16:31:52,818 P199553 INFO ************ Epoch=16 end ************
2025-05-13 16:31:57,450 P199553 INFO Train loss: 0.302220
2025-05-13 16:31:57,451 P199553 INFO Evaluation @epoch 17 - batch 145: 
2025-05-13 16:31:59,080 P199553 INFO ===
2025-05-13 16:31:59,081 P199553 INFO [Metrics] AUC: 0.905003 - logloss: 0.304821
2025-05-13 16:31:59,081 P199553 INFO Monitor(max)=0.905003 STOP!
2025-05-13 16:31:59,081 P199553 INFO Reduce learning rate on plateau: 0.000010
2025-05-13 16:31:59,258 P199553 INFO ************ Epoch=17 end ************
2025-05-13 16:32:03,800 P199553 INFO Train loss: 0.285845
2025-05-13 16:32:03,800 P199553 INFO Evaluation @epoch 18 - batch 145: 
2025-05-13 16:32:05,440 P199553 INFO ===
2025-05-13 16:32:05,440 P199553 INFO [Metrics] AUC: 0.904854 - logloss: 0.307899
2025-05-13 16:32:05,440 P199553 INFO Monitor(max)=0.904854 STOP!
2025-05-13 16:32:05,440 P199553 INFO Reduce learning rate on plateau: 0.000001
2025-05-13 16:32:05,441 P199553 INFO ********* Epoch==18 early stop *********
2025-05-13 16:32:05,629 P199553 INFO Training finished.
2025-05-13 16:32:05,629 P199553 INFO Load best model: /root/autodl-tmp/model_zoo/DCNv3/DCNv3_torch/checkpoints/ML_1M_7_x1/ECN_ML_1M_7_x1_007_9643bdea.model
2025-05-13 16:32:05,633 P199553 INFO ****** Validation evaluation ******
2025-05-13 16:32:07,308 P199553 INFO ===
2025-05-13 16:32:07,308 P199553 INFO [Metrics] logloss: 0.303927 - AUC: 0.905087
2025-05-13 16:32:07,353 P199553 INFO ******** Test evaluation ********
2025-05-13 16:32:07,353 P199553 INFO Loading data...
2025-05-13 16:32:07,353 P199553 INFO Loading data from h5: ../../../data/ML_1M_7_x1/test.h5
2025-05-13 16:32:07,358 P199553 INFO Test samples: total/73902, blocks/1
2025-05-13 16:32:07,358 P199553 INFO Loading test data done.
2025-05-13 16:32:09,000 P199553 INFO ===
2025-05-13 16:32:09,000 P199553 INFO [Metrics] logloss: 0.302837 - AUC: 0.905608
